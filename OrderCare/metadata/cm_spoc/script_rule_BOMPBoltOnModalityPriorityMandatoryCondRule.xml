<?xml version="1.0" encoding="UTF-8" ?>
<script name="cm_spoc.rule_BOMPBoltOnModalityPriorityMandatoryCondRule">
  <group>rules_scripts.Configuration</group>
  <label>rule_BOMPBoltOnModalityPriorityMandatoryCondRule</label>
  <metaVersion>4</metaVersion>
  <parameterList>
    <parameter name="data" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
    <parameter name="errList" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    //------------------------------------------- OLD
    //The attribute will be mandatory when the related attribute has the value shown in the column H.

    //SPOC Entity       -- BoltOnModalityPriorities
    //SPOC Entity attribute       --       BoltOnTypeModality
    //Related SPOC Entity -- BoltOnModalityPriority
    //Related SPOC Entity attribute --       GeneralPriority
    //COLUMN H -- FALSE
    /*var entity = data.BoltOnModalityPriorities;
    var bomp = data.BoltOnModalityPriority;

    if (!entity.BoltOnTypeModality && (!bomp.GeneralPriority)  ) {

        errList.addErrorMessage(data,["Type Moddality must be set"],"NGAA_003","E");
    }
        return false;
     */
    //----------------------------------------------  NEW --------------------------------------
    /* Conditional
     * BOMPBoltOnModalityPriorityMandatoryCondRule
     * The attribute will be mandatory when the related attribute has the value shown in the column H.
     *
     * BoltOnModalityPriorities
     * BoltOnTypeModality
     *
     * BoltOnModalityPriority
     * DefaultPriority
     *
     * TRUE

    */

    var entity = data.BoltOnModalityPriorities;
    var bomp = data.BoltOnModalityPriority;

    if (!entity.BoltOnTypeModality && bomp.DefaultPriority  ) {

        errList.addErrorMessage(data,["Type Modality must be set"],"NGAA_003","E");
    }
        return false;
  ]]></script>
</script>
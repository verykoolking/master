<?xml version="1.0" encoding="UTF-8" ?>
<userInterface name="cm_spoc.forms.UCBoltOnTypeAssociationForm">
  <group>UsageControl</group>
  <label>UCBoltOnTypeAssociationForm</label>
  <metaVersion>4</metaVersion>
  <variableList>
    <variable name="model" type="leaf">
      <valueType>dstruct_cm_spoc.data.UCBoltOnTypeAssociation</valueType>
    </variable>
  </variableList>
  <vformList>
    <vform name="Forms" type="frmui">
      <extends>ui_com.conceptwave.system.UserInterface/frmui_Forms</extends>
      <overlayList>
        <overlay name="Default" type="exov">
          <base>ui_com.conceptwave.system.UserInterface/frmui_Forms/vform_Default</base>
          <extends>ui_com.conceptwave.system.UserInterface/frmui_Forms/vform_Default</extends>
          <label>Default</label>
          <overrideList>
            <override name="VerticalLayout" type="elvlt">
              <width>850px</width>
              <elementList>
                <element name="SectionStack" type="elsectnstck">
                  <width>850px</width>
                  <elementList>
                    <element name="BoltOnTypeAssociationDetail" type="elsect">
                      <removeLabelLine>true</removeLabelLine>
                      <elementList>
                        <element name="BoltOnTypeAssociationDetailHeader" type="elsecth"/>
                        <element name="GridLayout1" type="elgrd">
                          <colWidths>100px</colWidths>
                          <numOfCols>3</numOfCols>
                          <width>300px</width>
                          <elementList>
                            <element name="RowSpacer" type="elrsp"/>
                            <element name="BoltOnTypeModEnum" type="elslct">
                              <columnSpan>3</columnSpan>
                              <labeAlign>left</labeAlign>
                              <label>Bolt-On Type Identifier</label>
                              <labelOrientation>left</labelOrientation>
                              <multiselect>false</multiselect>
                              <onChangeMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_boltOnTypeModalityTrigger</variablePath>
                                </variablePathList>
                              </onChangeMethod>
                              <optional type="varPath">
                                <variablePathList>
                                  <variablePath>dtype_com.conceptwave.system.Boolean/leaf_FALSE</variablePath>
                                </variablePathList>
                              </optional>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_BoltOnTypeModEnum</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="ThresholdEnum" type="elslct">
                              <columnSpan>1</columnSpan>
                              <labeAlign>left</labeAlign>
                              <label>Threshold</label>
                              <labelOrientation>left</labelOrientation>
                              <onChangeMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_setThreshold</variablePath>
                                </variablePathList>
                              </onChangeMethod>
                              <optional type="varPath">
                                <variablePathList>
                                  <variablePath>dtype_com.conceptwave.system.Boolean/leaf_FALSE</variablePath>
                                </variablePathList>
                              </optional>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_ThresholdEnum</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="IncreasedValue" type="elchk">
                              <columnSpan>2</columnSpan>
                              <label>Increased Value</label>
                              <labelAsTitle>false</labelAsTitle>
                              <labelOrientation>right</labelOrientation>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_IncreasedValue</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="UserMustHaveTheBoltOn" type="elchk">
                              <columnSpan>2</columnSpan>
                              <label>The User must have the bolt-on type</label>
                              <labelAsTitle>false</labelAsTitle>
                              <labelOrientation>right</labelOrientation>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_UserMustHaveTheBoltOn</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="Enabled" type="elrgrp">
                              <columnSpan>2</columnSpan>
                              <onChangeMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_selectTrigger</variablePath>
                                </variablePathList>
                              </onChangeMethod>
                              <removeLabelLine>true</removeLabelLine>
                              <showLabel>false</showLabel>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_Enabled</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="LastFreeUnitsOfTheCycle" type="elfld">
                              <columnSpan>1</columnSpan>
                              <dynLabel type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_UCBOASLastFreeUnitsOfTheCycleLabelXNVisRule</variablePath>
                                </variablePathList>
                              </dynLabel>
                              <editable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOASLastFreeUnitsOfTheCycleVisRule</variablePath>
                                </variablePathList>
                              </editable>
                              <labeAlign>left</labeAlign>
                              <label>Last Free Units of the cycle</label>
                              <labelOrientation>left</labelOrientation>
                              <optional type="varPath">
                                <variablePathList>
                                  <variablePath>dtype_com.conceptwave.system.Boolean/leaf_FALSE</variablePath>
                                </variablePathList>
                              </optional>
                              <removeLabelLine>true</removeLabelLine>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_LastFreeUnitsOfTheCycle</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="UnitsOrPercentageThreshold" type="elslct">
                              <columnSpan>1</columnSpan>
                              <editable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOTAUnitsOrPercentageEditRule</variablePath>
                                </variablePathList>
                              </editable>
                              <multiselect>false</multiselect>
                              <onChangeMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_selectTrigger</variablePath>
                                </variablePathList>
                              </onChangeMethod>
                              <removeLabelLine>true</removeLabelLine>
                              <showLabel>false</showLabel>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_UnitsOrPercentageThreshold</variablePath>
                                </variablePathList>
                              </variable>
                              <visible type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOTAUnitsOrPercentageThresholdUnitsVisRule</variablePath>
                                </variablePathList>
                              </visible>
                            </element>
                            <element name="Customize" type="elchk">
                              <columnSpan>1</columnSpan>
                              <label>Customize</label>
                              <labelAsTitle>false</labelAsTitle>
                              <labelOrientation>right</labelOrientation>
                              <onChangeMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_selectTrigger</variablePath>
                                </variablePathList>
                              </onChangeMethod>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_Customize</variablePath>
                                </variablePathList>
                              </variable>
                              <visible type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOASCustomizeVisRule</variablePath>
                                </variablePathList>
                              </visible>
                            </element>
                            <element name="UnitsOfCompleteCycle" type="elfld">
                              <columnSpan>1</columnSpan>
                              <editable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOASUnitsOfCompleteCycleReadORule</variablePath>
                                </variablePathList>
                              </editable>
                              <labeAlign>left</labeAlign>
                              <label>Units of a complete cycle</label>
                              <labelOrientation>left</labelOrientation>
                              <onChangeMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_selectTrigger</variablePath>
                                </variablePathList>
                              </onChangeMethod>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_UnitsOfCompleteCycle</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="RowSpacer1" type="elrsp"/>
                          </elementList>
                        </element>
                        <element name="GridLayout2" type="elgrd">
                          <colWidths>100px</colWidths>
                          <fixedColWidths>true</fixedColWidths>
                          <numOfCols>4</numOfCols>
                          <width>400px</width>
                          <elementList>
                            <element name="Separator" type="elsep">
                              <width>300px</width>
                            </element>
                            <element name="startDate" type="ellab">
                              <columnSpan>1</columnSpan>
                              <label>Start Date</label>
                            </element>
                            <element name="RowSpacer2" type="elrsp">
                              <height>10px</height>
                              <rowSpan>10px</rowSpan>
                            </element>
                            <element name="StartDate" type="eldate">
                              <columnSpan>1</columnSpan>
                              <editable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOTAStartDateReadORule</variablePath>
                                </variablePathList>
                              </editable>
                              <optional type="varPath">
                                <variablePathList>
                                  <variablePath>dtype_com.conceptwave.system.Boolean/leaf_FALSE</variablePath>
                                </variablePathList>
                              </optional>
                              <removeLabelLine>true</removeLabelLine>
                              <showLabel>false</showLabel>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_StartDate</variablePath>
                                </variablePathList>
                              </variable>
                              <visible type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOASStartDateVisRule</variablePath>
                                </variablePathList>
                              </visible>
                            </element>
                            <element name="ProvisionDay" type="elchk">
                              <columnSpan>1</columnSpan>
                              <editable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOTAProvisionDayReadORule</variablePath>
                                </variablePathList>
                              </editable>
                              <label>Provision Day</label>
                              <labelAsTitle>false</labelAsTitle>
                              <labelOrientation>right</labelOrientation>
                              <onChangeMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_selectTrigger</variablePath>
                                </variablePathList>
                              </onChangeMethod>
                              <removeLabelLine>true</removeLabelLine>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_ProvisionDay</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="Separator1" type="elsep">
                              <width>300px</width>
                            </element>
                            <element name="endDate" type="ellab">
                              <columnSpan>1</columnSpan>
                              <label>End Date</label>
                            </element>
                            <element name="RowSpacer3" type="elrsp">
                              <height>10px</height>
                              <rowSpan>10px</rowSpan>
                            </element>
                            <element name="BoltOnTypeEnd" type="elchk">
                              <columnSpan>1</columnSpan>
                              <editable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOTABoltOnTypeEndReadORule</variablePath>
                                </variablePathList>
                              </editable>
                              <label>Bolt-on type end</label>
                              <labelAsTitle>false</labelAsTitle>
                              <labelOrientation>right</labelOrientation>
                              <onChangeMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_selectTrigger</variablePath>
                                </variablePathList>
                              </onChangeMethod>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_BoltOnTypeEnd</variablePath>
                                </variablePathList>
                              </variable>
                            </element>
                            <element name="EndDate" type="eldate">
                              <columnSpan>1</columnSpan>
                              <editable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOTAEndDateReadORule</variablePath>
                                </variablePathList>
                              </editable>
                              <removeLabelLine>true</removeLabelLine>
                              <showLabel>false</showLabel>
                              <startRow>true</startRow>
                              <variable type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/leaf_model</variablePath>
                                  <variablePath>dstruct_cm_spoc.data.UCBoltOnTypeAssociation/dstruct_EndDate</variablePath>
                                </variablePathList>
                              </variable>
                              <visible type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/permMethod_UCBOASEndDateVisRule</variablePath>
                                </variablePathList>
                              </visible>
                            </element>
                            <element name="RowSpacer4" type="elrsp"/>
                            <element name="RowSpacer5" type="elrsp"/>
                            <element name="saveButton" type="elbtn">
                              <cellAlignment>right,center</cellAlignment>
                              <clickMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_onSaveClick</variablePath>
                                </variablePathList>
                              </clickMethod>
                              <columnSpan>2</columnSpan>
                              <label>Save</label>
                            </element>
                            <element name="cancelButton" type="elbtn">
                              <clickMethod type="varPath">
                                <variablePathList>
                                  <variablePath>ui_cm_spoc.forms.UCBoltOnTypeAssociationForm/uimthd_onCancelClick</variablePath>
                                </variablePathList>
                              </clickMethod>
                              <label>Cancel</label>
                            </element>
                            <element name="RowSpacer6" type="elrsp"/>
                          </elementList>
                        </element>
                      </elementList>
                    </element>
                  </elementList>
                </element>
              </elementList>
            </override>
          </overrideList>
        </overlay>
      </overlayList>
    </vform>
  </vformList>
  <methodList>
    <method name="UCBOASEndDateVisRule" type="permMethod">
      <script><![CDATA[
        var value = this.model.BoltOnTypeEnd;

        var s = new epc.data.Specification();
        s.project =  cwa_epc.getDefaultProj();
        s.specificationCode = this.model.BoltOnTypeModEnum;
        var r = epc.getSpecificationByKey(s);

        if(!api_common.isFault(r)){
            var btm = cm_spoc.initModelForModification(r);
            if ( btm.GeneralStartEndDateSpecDS.GeneralForBoltOn || value){
                return true;
            }
        }
        if( value )
            return true;
        this.model.EndDate = null;
        return false;
      ]]></script>
    </method>
    <method name="UCBOASLastFreeUnitsOfTheCycleVisRule" type="permMethod">
      <script><![CDATA[
        var value = this.model.Enabled;
        var units = this.model.UnitsOrPercentageThreshold;

        var btCode=this.model.BoltOnTypeModEnum;
        if(!this.parent.model.readonly){
            if(this.model.Enabled == 'E'){
                if(this.model.LastFreeUnitsOfTheCycle == -1 )
                    this.model.LastFreeUnitsOfTheCycle = '';
                return true;
            }
            else{
                this.model.LastFreeUnitsOfTheCycle = -1;
                return false;
            }
        }
        //this.model.LastFreeUnitsOfTheCycle = null;
        return false;
      ]]></script>
    </method>
    <method name="UCBOASStartDateVisRule" type="permMethod">
      <script><![CDATA[
        var value = this.model.ProvisionDay;

        var s = new epc.data.Specification();
        s.project =  cwa_epc.getDefaultProj();
        s.specificationCode = this.model.BoltOnTypeModEnum;
        var r = epc.getSpecificationByKey(s);
        if(!api_common.isFault(r)){
            var btm = cm_spoc.initModelForModification(r);
            if ( !btm.GeneralStartEndDateSpecDS.GeneralForBoltOn && value){
                this.model.StartDate = null;
                return false;
            }
        }
        if (value)
            return false;
        return true;
      ]]></script>
    </method>
    <method name="selectTrigger" type="uimthd">
      <script>return;</script>
    </method>
    <method name="UCBOASUnitsOfCompleteCycleReadORule" type="permMethod">
      <script><![CDATA[
        var value = this.model.Customize;
        var btCode=this.model.BoltOnTypeModEnum;
        if(!this.parent.model.readonly){
            if(btCode !=null){
                var btmJson = cm_spoc.getBoltOnTypeModality(btCode);
                var modalityCode =  btmJson.BoltOnTypeModalityCode;
                if ( value ){
                    if(this.model.UnitsOfCompleteCycle == -1)
                        this.model.UnitsOfCompleteCycle = null;
                    return true;
                }
                else {
                    this.model.UnitsOfCompleteCycle = -1;
                    return false;
                }
            }
        }
        return false;
      ]]></script>
    </method>
    <method name="UCBOASCustomizeVisRule" type="permMethod">
      <script><![CDATA[
        var btCode=this.model.BoltOnTypeModEnum;

        if(btCode!=null){

            var btmJson = cm_spoc.getBoltOnTypeModality(btCode);
            var modalityCode =  btmJson.BoltOnTypeModalityCode;

            if ( modalityCode == "XN" )
                return true;
            else {
                this.model.Customize = false;
                return false;
            }
        }
        return false;
      ]]></script>
    </method>
    <method name="UCBOASLastFreeUnitsOfTheCycleLabelXNVisRule" type="uimthd">
      <valueType>dtype_com.conceptwave.system.String</valueType>
      <script><![CDATA[
        //implements UCBOASLastFreeUnitsOfTheCycleLabelXNVisRule and UCBOASLastFreeUnitsOfTheCycleLabelOthersVisRule

        var btCode=this.model.BoltOnTypeModEnum;

        if(btCode !=null){
            var btmJson = cm_spoc.getBoltOnTypeModality(btCode);
            var modalityCode =  btmJson.BoltOnTypeModalityCode;

            if( modalityCode == "XN" )
                return "<nobr>Last Free Units of the cycle</nobr>";
            else
            return "<nobr>VALUE</nobr>";
        }
        return;
      ]]></script>
    </method>
    <method name="boltOnTypeModalityTrigger" type="uimthd">
      <script><![CDATA[
        if ( this.model.BoltOnType != this.model.BoltOnTypeModEnum){
            this.model.StartDate = null;
            this.model.EndDate = null;
            this.model.BoltOnTypeEnd = false;
            this.model.UnitsOrPercentageThreshold ='';
        }
        this.model.BoltOnType=this.model.BoltOnTypeModEnum;
      ]]></script>
    </method>
    <method name="setThreshold" type="uimthd">
      <script>this.model.Threshold = this.model.ThresholdEnum;</script>
    </method>
    <method name="onSaveClick" type="uimthd">
      <script>return cm_spoc.saveUCBOTAssociation(this);</script>
    </method>
    <method name="onCancelClick" type="uimthd">
      <script>this.parent.UCBoltOnTypeAssociationUI = null;</script>
    </method>
    <method name="UCBOTAProvisionDayReadORule" type="permMethod">
      <script><![CDATA[
        var s = new epc.data.Specification();
        s.project =  cwa_epc.getDefaultProj();
        s.specificationCode = this.model.BoltOnTypeModEnum;
        var r = epc.getSpecificationByKey(s);
        if(!this.parent.model.readonly){
            if(!api_common.isFault(r)){
                var btm = cm_spoc.initModelForModification(r);
                if ( btm.GeneralStartEndDateSpecDS.GeneralForBoltOn ){
                    this.model.ProvisionDay = false;
                    return false;
                }
            }
            return true;
        }
        return false;
      ]]></script>
    </method>
    <method name="UCBOTAStartDateReadORule" type="permMethod">
      <script><![CDATA[
        var s = new epc.data.Specification();
        s.project =  cwa_epc.getDefaultProj();
        s.specificationCode = this.model.BoltOnTypeModEnum;
        var r = epc.getSpecificationByKey(s);
        if(!this.parent.model.readonly){
            if(!api_common.isFault(r)){
                var btm = cm_spoc.initModelForModification(r);
                if ( btm.GeneralStartEndDateSpecDS.GeneralForBoltOn ){
                    this.model.StartDate = r.GeneralStartEndDateSpecDS.StartDateTime;
                    return false;
                }
            }
            return true;
        }
        return false;
      ]]></script>
    </method>
    <method name="UCBOTABoltOnTypeEndReadORule" type="permMethod">
      <script><![CDATA[
        var s = new epc.data.Specification();
        s.project =  cwa_epc.getDefaultProj();
        s.specificationCode = this.model.BoltOnTypeModEnum;
        var r = epc.getSpecificationByKey(s);
        if(!this.parent.model.readonly){
            if(!api_common.isFault(r)){
                var btm = cm_spoc.initModelForModification(r);
                if ( btm.GeneralStartEndDateSpecDS.GeneralForBoltOn ){
                    this.model.BoltOnTypeEnd = true;
                    return false;
                }
            }
        return true;
        }
        return false;
      ]]></script>
    </method>
    <method name="UCBOTAEndDateReadORule" type="permMethod">
      <script><![CDATA[
        var s = new epc.data.Specification();
        s.project =  cwa_epc.getDefaultProj();
        s.specificationCode = this.model.BoltOnTypeModEnum;
        var r = epc.getSpecificationByKey(s);
        if(!this.parent.model.readonly){
            if(!api_common.isFault(r)){
                var btm = cm_spoc.initModelForModification(r);
                if ( btm.GeneralStartEndDateSpecDS.GeneralForBoltOn ){

                    this.model.EndDate = r.GeneralStartEndDateSpecDS.EndDateTime;
                    return false;
                }
            }
            return true;
        }
        return false;
      ]]></script>
    </method>
    <method name="UCBOTAUnitsOrPercentageThresholdUnitsVisRule" type="permMethod">
      <script><![CDATA[
        var btCode=this.model.BoltOnTypeModEnum;
        if(!this.parent.model.readonly){
            if (btCode!=null){

                var btmJson = cm_spoc.getBoltOnTypeModality(btCode);
                var modalityCode =  btmJson.BoltOnTypeModalityCode;

                if(  modalityCode == "XN" || modalityCode  == "CR" || modalityCode == "PH"  ){
                   this.model.UnitsOrPercentageThreshold = 'U';
                }

            }
        }
        return;
      ]]></script>
    </method>
    <method name="UCBOTAUnitsOrPercentageEditRule" type="permMethod">
      <script><![CDATA[
        if(this.model.Enabled == 'E'){
            return true;
        }
        this.model.UnitsOrPercentageThreshold = '';
        return false;
      ]]></script>
    </method>
  </methodList>
</userInterface>
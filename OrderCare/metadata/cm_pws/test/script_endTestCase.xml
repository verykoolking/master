<?xml version="1.0" encoding="UTF-8" ?>
<script name="cm_pws.test.endTestCase">
  <group>scripts</group>
  <label>endTestCase</label>
  <metaVersion>4</metaVersion>
  <parameterList>
    <parameter name="name" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="owner" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var log = cm_pws.test.clsLog();
    name = owner.visualKey;
    var testCaseInfo =  "Test case '" + name + "' - FINISHED";
    try{
        log.newLine();
        log.writeLn(testCaseInfo);

        //resetting the level
        var testOwner = Global.getSessionParameter("TEST_OWNER");
        if(testOwner == owner.metadata){
            Global.rollbackTransaction("CATALOG");
            Global.rollbackTransaction("ORDER");
            log.writeLn("Rolled  back!");
            cm_pws.test.testRollbackImportCatalog();
            Global.setSessionParameter("TEST_OWNER", null);
        }
        ///
    }catch(exp){
        log.writeLn(exp);
        Global.throwException("EXP", exp);

    }
  ]]></script>
</script>
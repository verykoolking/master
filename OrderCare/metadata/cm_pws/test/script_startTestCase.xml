<?xml version="1.0" encoding="UTF-8" ?>
<script name="cm_pws.test.startTestCase">
  <group>scripts</group>
  <label>startTestCase</label>
  <metaVersion>4</metaVersion>
  <parameterList>
    <parameter name="name" type="rifp">
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="owner" type="rifp">
      <type>nmeta_com.conceptwave.system.Object</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    var log = cm_pws.test.clsLog();
    name = owner.visualKey;
    var testCaseInfo =  "Test case '" + name + "' - STARTED";
    try{
        log.newLine();
        log.writeLn(testCaseInfo);

        //setting the level
        var testOwner = Global.getSessionParameter("TEST_OWNER");
        if(!testOwner){
            Global.setSessionParameter("TEST_OWNER", owner.metadata);
            cm_pws.test.testImportCatalog();

            var projectCode = "TEST_CASE_CATALOG_PROJECT";
            var projectSearchDS = new cwt_pcmaintapi.projectSearchDS();
            projectSearchDS.projectCode = projectCode;

            var projectDS = cwt_pcmaintapi.projectSearch(projectSearchDS);
            projectDS = projectDS.projects[0];

            //change the startDate of the project
            projectDS.effectiveDate = new Date(new Date().getTime() + 10*60*60*1000);// =  - (new Date()).getTime() - (10*60*60*1000);
            var response = cwt_pcmaintapi.projectUpdate(projectDS);
            if(cwt_pcmaintapi.isFault(response))
            {
                log.writeLn("Error updating project: " + response.toXML());
                assertTrue(false);
            }

            var projectDS = new cwt_pcmaintapi.projectsActivationDS();
            projectDS.projectCodes[0] = projectCode;
            response = cwt_pcmaintapi.projectActive(projectDS);
            if(cwt_pcmaintapi.isFault(response) || response.code == "ERROR"){
                log.writeLn("Error activating project: " + response.toXML());
                assertTrue(false);
            }

            //Activate Project:
            var result = synchronization.activateProject(projectCode);
            if(api_common.isFault(result)) {
                 Global.throwException("Error trying to activate the Project");
            }
        }
        ///
    }catch(exp){
        log.writeLn(exp);
        Global.throwException("EXP", exp);
    }
  ]]></script>
</script>
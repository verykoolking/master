<?xml version="1.0" encoding="UTF-8" ?>
<script name="pm_sr.updateEntity">
  <label>updateEntity</label>
  <metaVersion>4</metaVersion>
  <parameterList>
    <parameter name="subscriberId" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="offerType" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="productSerialNumber" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.String</type>
    </parameter>
    <parameter name="endDate" type="rifp">
      <mandatory>true</mandatory>
      <type>dtype_com.conceptwave.system.Date</type>
    </parameter>
  </parameterList>
  <script><![CDATA[
    /**
     * Service Registry
     * Update Entity
     *
     * @author  Vitor Brasileiro
     * @date    20140529
     */


    Global.runDBUpdate("ORDER", "UPDATE CWT_SR_ENTITY      set VALIDTODATE = TO_DATE('" + endDate + "', 'YYYY/MM/DD') WHERE APPLICATIONCONTEXT = '"       + subscriberId + "' AND ENTITYTYPE = '" + offerType + "' AND DN = '"       + productSerialNumber + "'");
    Global.runDBUpdate("ORDER", "UPDATE CWT_SR_ENTITYVALUE set VALIDTODATE = TO_DATE('" + endDate + "', 'YYYY/MM/DD') WHERE ENTITYAPPLICATIONCONTEXT = '" + subscriberId + "' AND ENTITYTYPE = '" + offerType + "' AND ENTITYDN = '" + productSerialNumber + "'");
    Global.commitTransaction("ORDER");
  ]]></script>
</script>